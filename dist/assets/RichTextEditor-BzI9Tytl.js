import{c as b,r as E,j as i}from"./index-BAUYqbCF.js";import{C as M}from"./code-BwXk2gKt.js";import{L as K}from"./list--qPCtZr0.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=b("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=b("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=b("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=b("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g=b("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),F=({value:n,onChange:h,placeholder:S="开始撰写您的攻略内容...",className:T=""})=>{const u=E.useRef(null),p=(e,t)=>{u.current&&(u.current.focus(),u.current.setSelectionRange(e,t||e))},D=()=>{const e=u.current;if(!e)return!1;const t=e.selectionStart,r=e.selectionEnd,o=n.substring(0,t),s=n.substring(r),c=o.lastIndexOf("```"),d=s.indexOf("```");if(c!==-1&&(d===-1||c>o.lastIndexOf("```",c)))return!0;const y=o.match(/`([^`]*)$/),a=s.match(/^([^`]*)`/);return!!(y&&a)},l=(e,t="",r="")=>{const o=u.current;if(!o)return;const s=o.selectionStart,c=o.selectionEnd,f=n.substring(s,c)||r,y=n.substring(0,s)+e+f+t+n.substring(c);h(y);const a=s+e.length+f.length;setTimeout(()=>{p(a,a)},0)},k=()=>{l("**","**","加粗文本")},C=()=>{l("*","*","斜体文本")},x=e=>{const t="#".repeat(e)+" ";l(t,"","标题")},I=()=>{const e=u.current;if(!e)return;const t=e.selectionStart,r=e.selectionEnd,o=n.substring(t,r),s=n.substring(0,t),c=n.substring(r),d=s.lastIndexOf("```"),f=c.indexOf("```");if(d!==-1&&(f===-1||d>s.lastIndexOf("```",d)))return;const a=s.match(/`([^`]*)$/),m=c.match(/^([^`]*)`/);if(a&&m){const O=n.substring(0,t-a[0].length)+a[1]+m[1]+n.substring(r+m[0].length);h(O);const v=t-a[0].length;setTimeout(()=>{p(v,v+a[1].length+m[1].length)},0)}else o&&o.trim()?l("`","`",""):l("`","`","代码")},w=()=>{l("```\n","\n```",`// 在这里输入您的代码
console.log("Hello World!");`)},B=()=>{l("[","](链接地址)","链接文本")},j=()=>{const e=u.current;if(!e)return;const t=e.selectionStart,r=e.selectionEnd;n.substring(t,r);const o=n.lastIndexOf(`
`,t-1)+1,s=n.substring(o,r);if(s.trim().startsWith("- ")){const c=n.substring(0,o)+s.replace(/^- /,"")+n.substring(r);h(c);const d=t-2;setTimeout(()=>{p(d,d)},0)}else l("- ","","列表项")},L=()=>{l("> ","","引用文本")},N=[{label:"加粗",action:k,icon:R,shortcut:"Ctrl+B"},{label:"斜体",action:C,icon:$,shortcut:"Ctrl+I"},{label:"一级标题",action:()=>x(1),icon:g,shortcut:"Ctrl+1"},{label:"二级标题",action:()=>x(2),icon:g,shortcut:"Ctrl+2"},{label:"三级标题",action:()=>x(3),icon:g,shortcut:"Ctrl+3"},{label:"代码",action:I,icon:M,shortcut:"Ctrl+`"},{label:"代码块",action:w,icon:M,shortcut:"Ctrl+Shift+`"},{label:"超链接",action:B,icon:H,shortcut:"Ctrl+K"},{label:"列表",action:j,icon:K,shortcut:"Ctrl+L"},{label:"引用",action:L,icon:g,shortcut:"Ctrl+Q"}];return E.useEffect(()=>{const e=t=>{if(t.ctrlKey||t.metaKey)switch(t.key){case"b":t.preventDefault(),k();break;case"i":t.preventDefault(),C();break;case"1":t.preventDefault(),x(1);break;case"2":t.preventDefault(),x(2);break;case"3":t.preventDefault(),x(3);break;case"`":t.preventDefault(),t.shiftKey?w():I();break;case"k":t.preventDefault(),B();break;case"l":t.preventDefault(),j();break;case"q":t.preventDefault(),L();break}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[n]),i.jsxs("div",{className:`rich-text-editor ${T}`,children:[i.jsxs("div",{className:"bg-gray-700/50 rounded-t-lg p-3 border-b border-gray-600",children:[i.jsx("div",{className:"flex flex-wrap gap-2",children:N.map((e,t)=>{const r=e.icon,s=e.label==="代码"&&D();return i.jsxs("button",{onClick:e.action,className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors text-sm font-medium ${s?"bg-blue-600 text-white":"bg-gray-600 hover:bg-gray-500 text-gray-300 hover:text-white"}`,title:`${e.label} (${e.shortcut})`,children:[i.jsx(r,{size:16}),i.jsx("span",{children:e.label})]},t)})}),i.jsx("div",{className:"mt-2 text-xs text-gray-400",children:"快捷键：Ctrl+B(加粗) Ctrl+I(斜体) Ctrl+1/2/3(标题) Ctrl+K(链接) Ctrl+L(列表)"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("textarea",{ref:u,value:n,onChange:e=>h(e.target.value),placeholder:S,className:"w-full min-h-[400px] p-4 bg-gray-700 rounded-b-lg border border-gray-600 focus:border-blue-500 focus:outline-none resize-none text-white placeholder-gray-400 font-mono text-sm leading-relaxed",style:{fontFamily:'Monaco, Menlo, "Ubuntu Mono", monospace'}}),i.jsxs("div",{className:"absolute bottom-2 right-2 text-xs text-gray-400 bg-gray-800 px-2 py-1 rounded",children:[n.length," 字符"]})]})]})};export{F as R,V as S};
