import{b as R,u as J,r as o,j as e}from"./index-Du8BMbyU.js";import{g as K,a as O,u as Q,d as U}from"./databaseBoardManager-DAhEahQI.js";import{S as V,a as W,b as Y,c as Z,d as _,e as x,f as u,g as p,h as g,i as ee,j as se,k as te,l as le,m as re,n as oe,o as ne,p as ie,q as ae,r as A,s as S,t as C,u as n,v as y,w as M,x as T,y as w,z as N}from"./StyledManagementPage-63J9W30c.js";import{A as ce}from"./arrow-left-gJmRVtYo.js";import{P as de}from"./plus-BASjHXxA.js";import{C as xe}from"./calendar-DRkchnUS.js";const ye=()=>{const E=R(),{currentTheme:i}=J(),[a,h]=o.useState([]),[z,k]=o.useState(!0),[D,m]=o.useState(!1),[L,f]=o.useState(!1),[B,v]=o.useState(null),[d,b]=o.useState(null),[t,l]=o.useState({name:"",description:"",icon:"🎮",color:"from-blue-600 to-purple-600"});o.useEffect(()=>{P()},[]);const P=async()=>{try{console.log("加载板块数据...");const s=await K();console.log("加载的板块:",s),h(s),k(!1)}catch(s){console.error("加载板块失败:",s),k(!1)}},F=async()=>{try{console.log("创建板块:",t);const s=await O({...t,order:0,isActive:!0});h([...a,s]),m(!1),l({name:"",description:"",icon:"🎮",color:"from-blue-600 to-purple-600"}),console.log("板块创建成功")}catch(s){console.error("创建板块失败:",s)}},I=async()=>{if(d)try{console.log("更新板块:",d.id,t);const s=await Q(d.id,{...t,order:d.order,isActive:d.isActive});s&&(h(a.map(r=>r.id===d.id?s:r)),f(!1),b(null),l({name:"",description:"",icon:"🎮",color:"from-blue-600 to-purple-600"}),j("板块更新成功！","success"),console.log("板块更新成功"))}catch(s){console.error("更新板块失败:",s),j("板块更新失败，请重试","error")}},$=async s=>{try{console.log("删除板块:",s),await U(s)&&(h(a.filter(c=>c.id!==s)),v(null),j("板块删除成功！","success"),console.log("板块删除成功"))}catch(r){console.error("删除板块失败:",r),j("板块删除失败，请重试","error")}},H=s=>{b(s),l({name:s.name,description:s.description,icon:s.icon,color:s.color}),f(!0)},X=s=>new Date(s).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),j=(s,r)=>{const c=document.createElement("div"),q=r==="success"?i.colors.success:i.colors.error,G=r==="success"?"✅":"❌";c.innerHTML=`
      <div style="
        position: fixed;
        top: 150px;
        right: 200px;
        background: ${q};
        color: white;
        padding: 16px 24px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        z-index: 10000;
        font-family: system-ui, -apple-system, sans-serif;
        font-size: 14px;
        font-weight: 500;
        animation: slideIn 0.3s ease-out;
        max-width: 300px;
      ">
        ${G} ${s}
      </div>
      <style>
        @keyframes slideIn {
          from { transform: translateX(100%); opacity: 0; }
          to { transform: translateX(0); opacity: 1; }
        }
      </style>
    `,document.body.appendChild(c),setTimeout(()=>{c.parentNode&&c.parentNode.removeChild(c)},3e3)};return z?e.jsx("div",{className:"min-h-screen text-white flex items-center justify-center",style:{backgroundColor:i.colors.background},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto mb-4",style:{borderColor:i.colors.textSecondary}}),e.jsx("p",{style:{color:i.colors.text},children:"加载中..."})]})}):e.jsx(V,{children:e.jsxs(W,{children:[e.jsxs(Y,{children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(Z,{onClick:()=>E(-1),children:[e.jsx(ce,{size:16}),"返回"]}),e.jsx(_,{children:"板块管理"})]}),e.jsxs(x,{onClick:()=>m(!0),children:[e.jsx(de,{size:16}),"创建板块"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsxs(u,{children:[e.jsx(p,{children:a.length}),e.jsx(g,{children:"总板块数"})]}),e.jsxs(u,{children:[e.jsx(p,{children:a.filter(s=>s.isActive).length}),e.jsx(g,{children:"活跃板块"})]}),e.jsxs(u,{children:[e.jsx(p,{children:"0"}),e.jsx(g,{children:"总主题数"})]}),e.jsxs(u,{children:[e.jsx(p,{children:"0"}),e.jsx(g,{children:"总文章数"})]})]}),e.jsxs(ee,{children:[e.jsx(se,{children:"板块列表"}),a.length===0?e.jsxs(te,{children:[e.jsx(le,{children:"暂无板块数据"}),e.jsx(x,{onClick:()=>m(!0),children:"创建第一个板块"})]}):e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsxs(re,{children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-2xl",children:s.icon}),e.jsxs("div",{children:[e.jsx(oe,{children:s.name}),e.jsx(ne,{children:s.description}),e.jsxs(ie,{children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(xe,{size:12}),X(s.createdAt)]}),e.jsx(ae,{isActive:s.isActive,children:s.isActive?"活跃":"已关闭"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm",style:{color:i.colors.textSecondary},children:[s.topicCount," 个主题"]}),e.jsx(x,{onClick:()=>H(s),className:"px-3 py-1 text-sm",children:"编辑"}),e.jsx(A,{onClick:()=>v(s.id),className:"px-3 py-1 text-sm",children:"删除"})]})]},s.id))})]}),D&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs(S,{children:[e.jsx(C,{children:"创建板块"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"板块名称"}),e.jsx(y,{value:t.name,onChange:s=>l({...t,name:s.target.value}),placeholder:"输入板块名称"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"板块描述"}),e.jsx(M,{value:t.description,onChange:s=>l({...t,description:s.target.value}),placeholder:"输入板块描述",rows:3})]}),e.jsxs("div",{children:[e.jsx(n,{children:"图标"}),e.jsx(y,{value:t.icon,onChange:s=>l({...t,icon:s.target.value}),placeholder:"选择图标"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"颜色"}),e.jsxs(T,{value:t.color,onChange:s=>l({...t,color:s.target.value}),children:[e.jsx("option",{value:"from-blue-600 to-purple-600",children:"蓝色到紫色"}),e.jsx("option",{value:"from-green-600 to-teal-600",children:"绿色到青色"}),e.jsx("option",{value:"from-red-600 to-pink-600",children:"红色到粉色"}),e.jsx("option",{value:"from-yellow-600 to-orange-600",children:"黄色到橙色"})]})]})]}),e.jsxs(w,{children:[e.jsx(N,{onClick:()=>m(!1),children:"取消"}),e.jsx(x,{onClick:F,children:"创建"})]})]})}),L&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs(S,{children:[e.jsx(C,{children:"编辑板块"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"板块名称"}),e.jsx(y,{value:t.name,onChange:s=>l({...t,name:s.target.value}),placeholder:"输入板块名称"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"板块描述"}),e.jsx(M,{value:t.description,onChange:s=>l({...t,description:s.target.value}),placeholder:"输入板块描述",rows:3})]}),e.jsxs("div",{children:[e.jsx(n,{children:"图标"}),e.jsx(y,{value:t.icon,onChange:s=>l({...t,icon:s.target.value}),placeholder:"选择图标"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"颜色"}),e.jsxs(T,{value:t.color,onChange:s=>l({...t,color:s.target.value}),children:[e.jsx("option",{value:"from-blue-600 to-purple-600",children:"蓝色到紫色"}),e.jsx("option",{value:"from-green-600 to-teal-600",children:"绿色到青色"}),e.jsx("option",{value:"from-red-600 to-pink-600",children:"红色到粉色"}),e.jsx("option",{value:"from-yellow-600 to-orange-600",children:"黄色到橙色"})]})]})]}),e.jsxs(w,{children:[e.jsx(N,{onClick:()=>f(!1),children:"取消"}),e.jsx(x,{onClick:I,children:"保存"})]})]})}),B&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs(S,{children:[e.jsx(C,{children:"确认删除"}),e.jsx("p",{className:"mb-6",style:{color:i.colors.textSecondary},children:"确定要删除这个板块吗？此操作不可撤销。"}),e.jsxs(w,{children:[e.jsx(N,{onClick:()=>v(null),children:"取消"}),e.jsx(A,{onClick:()=>$(B),children:"删除"})]})]})})]})})};export{ye as default};
