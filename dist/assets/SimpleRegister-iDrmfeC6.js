import{r as i,j as e}from"./index-BAUYqbCF.js";const _=(s,o)=>{try{if(console.log("开始简单注册:",{username:s,password:o}),!s.trim()||!o.trim())return{success:!1,message:"用户名和密码不能为空"};if(s.length<3)return{success:!1,message:"用户名至少3个字符"};if(o.length<6)return{success:!1,message:"密码至少6个字符"};const t=b();if(console.log("现有用户:",t),t.find(m=>m.username===s))return{success:!1,message:"用户名已存在"};const c={id:`user_${Date.now()}`,username:s,password:o,userType:"regular",createdAt:new Date().toISOString()};return t.push(c),localStorage.setItem("simple_users",JSON.stringify(t)),localStorage.setItem("simple_current_user",JSON.stringify(c)),console.log("注册成功:",c),{success:!0,message:"注册成功！"}}catch(t){return console.error("注册失败:",t),{success:!1,message:`注册失败: ${t}`}}},L=(s,o)=>{try{if(console.log("开始简单登录:",{username:s,password:o}),!s.trim()||!o.trim())return{success:!1,message:"用户名和密码不能为空"};const a=b().find(c=>c.username===s);return a?a.password!==o?{success:!1,message:"密码错误"}:(localStorage.setItem("simple_current_user",JSON.stringify(a)),console.log("登录成功:",a),{success:!0,message:"登录成功！"}):{success:!1,message:`用户 "${s}" 不存在`}}catch(t){return console.error("登录失败:",t),{success:!1,message:`登录失败: ${t}`}}},b=()=>{try{const s=localStorage.getItem("simple_users");return s?JSON.parse(s):[]}catch(s){return console.error("获取用户列表失败:",s),[]}},k=()=>{try{const s=localStorage.getItem("simple_current_user");return s?JSON.parse(s):null}catch(s){return console.error("获取当前用户失败:",s),null}},I=()=>{localStorage.removeItem("simple_current_user")},R=()=>{localStorage.removeItem("simple_current_user")},J=()=>{const[s,o]=i.useState(""),[t,a]=i.useState(""),[c,m]=i.useState(""),[p,l]=i.useState(""),[u,f]=i.useState(!1),[x,y]=i.useState(""),[h,j]=i.useState(""),[g,N]=i.useState(!1),d=()=>{const r=k(),n=b();console.log("当前状态:",{currentUser:r,allUsers:n});const U=r?`当前用户: ${r.username} (${r.userType})`:"当前用户: 无";l(`${U} | 总用户数: ${n.length}`)},v=()=>{I(),l("当前用户已清除"),d()},w=()=>{if(!x.trim()||!h.trim()){l("❌ 请填写用户名和密码");return}N(!0),l("登录中...");try{const r=L(x,h);r.success?(l(`✅ ${r.message}`),y(""),j(""),d()):l(`❌ ${r.message}`)}catch(r){l(`❌ 登录错误: ${r.message}`)}finally{N(!1)}},S=()=>{R(),l("已登出"),d()},$=()=>s.trim()?s.length<3?"用户名至少3个字符":t?t.length<6?"密码至少6个字符":t!==c?"两次输入的密码不一致":null:"请输入密码":"请输入用户名",C=async()=>{const r=$();if(r){l(`❌ ${r}`);return}f(!0),l("注册中...");try{const n=_(s,t);n.success?(l(`✅ ${n.message}`),o(""),a(""),m(""),setTimeout(()=>{d()},1e3)):l(`❌ ${n.message}`)}catch(n){console.error("注册错误:",n),l(`❌ 注册失败: ${n}`)}finally{f(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-900 text-white pt-20",children:e.jsx("div",{className:"container mx-auto px-6 py-8",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center",children:"简单注册"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"状态检查"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:d,className:"w-full py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"检查当前状态"}),e.jsx("button",{onClick:v,className:"w-full py-2 px-4 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"清除当前用户"}),e.jsx("button",{onClick:S,className:"w-full py-2 px-4 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:"登出"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"登录"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"用户名"}),e.jsx("input",{type:"text",value:x,onChange:r=>y(r.target.value),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入用户名",disabled:g})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"密码"}),e.jsx("input",{type:"password",value:h,onChange:r=>j(r.target.value),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入密码",disabled:g})]}),e.jsx("button",{onClick:w,disabled:g,className:`w-full py-3 px-4 rounded-lg transition-colors font-medium ${g?"bg-gray-600 text-gray-300 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 hover:shadow-lg"}`,children:g?"登录中...":"立即登录"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"注册新账户"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"用户名"}),e.jsx("input",{type:"text",value:s,onChange:r=>o(r.target.value),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入用户名（至少3个字符）",disabled:u})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"密码"}),e.jsx("input",{type:"password",value:t,onChange:r=>a(r.target.value),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入密码（至少6个字符）",disabled:u})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"确认密码"}),e.jsx("input",{type:"password",value:c,onChange:r=>m(r.target.value),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请再次输入密码",disabled:u})]}),e.jsx("button",{onClick:C,disabled:u,className:`w-full py-3 px-4 rounded-lg transition-colors font-medium ${u?"bg-gray-600 text-gray-300 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700 hover:shadow-lg"}`,children:u?"注册中...":"立即注册"})]})]}),p&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"结果"}),e.jsx("p",{className:"text-lg",children:p})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mt-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"使用说明"}),e.jsxs("div",{className:"text-sm text-gray-300 space-y-2",children:[e.jsx("p",{children:"• 这是一个完全独立的注册系统"}),e.jsx("p",{children:"• 只检查用户名是否重复"}),e.jsx("p",{children:"• 不依赖复杂的用户状态管理"}),e.jsx("p",{children:"• 注册成功后会自动设置为当前用户"})]})]})]})})})};export{J as default};
