import{K as a}from"./index-Du8BMbyU.js";const s={useDatabase:!0,fallbackToLocalStorage:!1,apiBaseUrl:"/api"};class n{constructor(t={}){this.config={...s,...t}}async getAllTopics(){try{if(this.config.useDatabase){const t=await a.topics.getAllTopics();if(t.success&&t.data)return(t.data.data||t.data).map(r=>({id:r.id,name:r.name,description:r.description||"",boardId:r.board_id||"",icon:r.icon||"🌟",color:r.color||"from-yellow-500 to-orange-500",order:r.sort_order||0,isActive:r.is_active===1||r.is_active===!0,articleCount:r.article_count||0,createdAt:r.created_at,updatedAt:r.updated_at}))}return this.config.fallbackToLocalStorage?(console.warn("⚠️ 数据库不可用，Topic管理不支持localStorage fallback"),[]):[]}catch(t){return console.error("获取主题列表失败:",t),[]}}async getTopicById(t){try{if(this.config.useDatabase){const e=await a.topics.getTopicById(t);if(e.success&&e.data){const r=e.data;return{id:r.id,name:r.name,description:r.description||"",boardId:r.board_id||"",icon:r.icon||"🌟",color:r.color||"from-yellow-500 to-orange-500",order:r.sort_order||0,isActive:r.is_active===1||r.is_active===!0,articleCount:r.article_count||0,createdAt:r.created_at,updatedAt:r.updated_at}}}return null}catch(e){return console.error("根据ID获取主题失败:",e),null}}async getTopicsByBoardId(t){try{if(this.config.useDatabase){const e=await a.topics.getTopicsByBoardId(t);if(e.success&&e.data)return(e.data.data||e.data).map(o=>({id:o.id,name:o.name,description:o.description||"",boardId:o.board_id||"",icon:o.icon||"🌟",color:o.color||"from-yellow-500 to-orange-500",order:o.sort_order||0,isActive:o.is_active===1||o.is_active===!0,articleCount:o.article_count||0,createdAt:o.created_at,updatedAt:o.updated_at}))}return[]}catch(e){return console.error("根据板块ID获取主题失败:",e),[]}}async addTopic(t){try{if(this.config.useDatabase){const e=await a.topics.createTopic({name:t.name,description:t.description,board_id:t.boardId,icon:t.icon,color:t.color,sort_order:t.order,is_active:t.isActive});if(e.success&&e.data){const r=e.data;return{id:r.id,name:r.name,description:r.description||"",boardId:r.board_id||"",icon:r.icon||"🌟",color:r.color||"from-yellow-500 to-orange-500",order:r.sort_order||0,isActive:r.is_active===1||r.is_active===!0,articleCount:r.article_count||0,createdAt:r.created_at,updatedAt:r.updated_at}}else throw new Error(e.error||"创建主题失败")}throw new Error("数据库不可用")}catch(e){throw console.error("添加主题失败:",e),e}}async updateTopic(t,e){try{if(this.config.useDatabase){const r=await a.topics.updateTopic(t,{name:e.name,description:e.description,board_id:e.boardId,icon:e.icon,color:e.color,sort_order:e.order,is_active:e.isActive});if(r.success&&r.data){const o=r.data;return{id:o.id,name:o.name,description:o.description||"",boardId:o.board_id||"",icon:o.icon||"🌟",color:o.color||"from-yellow-500 to-orange-500",order:o.sort_order||0,isActive:o.is_active===1||o.is_active===!0,articleCount:o.article_count||0,createdAt:o.created_at,updatedAt:o.updated_at}}else throw new Error(r.error||"更新主题失败")}throw new Error("数据库不可用")}catch(r){throw console.error("更新主题失败:",r),r}}async deleteTopic(t){try{if(this.config.useDatabase)return(await a.topics.deleteTopic(t)).success;throw new Error("数据库不可用")}catch(e){throw console.error("删除主题失败:",e),e}}async getTopicStats(){try{if(this.config.useDatabase){const t=await a.topics.getTopicStats();if(t.success&&t.data)return t.data}return{total_topics:0,active_topics:0,total_articles:0,avg_articles_per_topic:0}}catch(t){return console.error("获取主题统计失败:",t),{total_topics:0,active_topics:0,total_articles:0,avg_articles_per_topic:0}}}async testConnection(){try{return await a.testConnection()}catch(t){return console.error("测试数据库连接失败:",t),!1}}switchDataSource(t){console.warn("在MySQL-only架构中，switchDataSource方法不再有实际作用")}}const i=new n,l=()=>i.getAllTopics(),u=c=>i.addTopic(c),_=(c,t)=>i.updateTopic(c,t),p=c=>i.deleteTopic(c);export{u as a,p as d,l as g,_ as u};
