import{r as m,j as e}from"./index-Du8BMbyU.js";const L=({onResults:g})=>{const[u,b]=m.useState(""),[o,p]=m.useState([]),[x,f]=m.useState(!1),[j,y]=m.useState("");m.useRef(null);const w=async t=>{const a=Date.now(),s={url:t,canEmbed:!1,isAccessible:!1,isInteractive:!1,status:"checking"};try{let r=null;try{r=await fetch(t,{method:"HEAD",mode:"cors",credentials:"omit",signal:AbortSignal.timeout(5e3)}),s.isAccessible=r.ok,s.responseTime=Date.now()-a}catch(c){console.log("HEAD request failed, trying GET request:",c)}let n=r;if(!r||!r.ok)try{n=await fetch(t,{method:"GET",mode:"cors",credentials:"omit",signal:AbortSignal.timeout(1e4)}),s.isAccessible=n.ok,s.responseTime=Date.now()-a}catch(c){if(N(t))return s.isAccessible=!0,s.canEmbed=!0,s.status="success",s.error="无法完全验证，但URL格式正确",s;throw c}if(!n||!n.ok)return s.error=`HTTP ${(n==null?void 0:n.status)||"Unknown"}: ${(n==null?void 0:n.statusText)||"Request failed"}`,s.status="error",s;const l=n.headers.get("X-Frame-Options");if(s.frameOptions=l||"Not set",l){const c=l.toLowerCase();if(c.includes("deny"))return s.error=`X-Frame-Options blocks embedding: ${l}`,s.status="error",s;if(c.includes("sameorigin")&&!k(t)&&!E(t))return s.error=`X-Frame-Options SAMEORIGIN may block embedding: ${l}`,s.status="error",s}const d=n.headers.get("Content-Security-Policy");return d&&d.includes("frame-ancestors 'none'")?(s.error="Content-Security-Policy blocks embedding",s.status="error",s):(n.redirected&&(s.redirectUrl=n.url),s.canEmbed=!0,s.status="success",await v(t,s),s)}catch(r){return N(t)?(s.isAccessible=!0,s.canEmbed=!0,s.status="success",s.error="无法完全验证，但URL格式正确，建议手动测试",s.responseTime=Date.now()-a,s):(s.error=r instanceof Error?r.message:"Unknown error",s.status="error",s.responseTime=Date.now()-a,s)}},v=async(t,a)=>new Promise(s=>{const r=document.createElement("iframe");r.src=t,r.style.width="100%",r.style.height="300px",r.style.border="none",r.style.position="absolute",r.style.left="-9999px",r.style.top="-9999px";let n=!1,l=!1;const d=()=>{r.parentNode&&r.parentNode.removeChild(r),s()},c=setTimeout(()=>{n||(a.error="Iframe loading timeout",d())},1e4);r.onload=()=>{var h;n=!0,clearTimeout(c);try{const i=r.contentDocument||((h=r.contentWindow)==null?void 0:h.document);if(i){const T=i.querySelector("canvas"),U=i.querySelectorAll('[class*="game"], [id*="game"], [class*="play"], [id*="play"]'),A=i.querySelectorAll("button, input, select, textarea, [onclick], [onmousedown]");l=T!==null||U.length>0||A.length>0,l?a.isInteractive=!0:a.error="No interactive game elements found"}else a.error="Cannot access iframe content (cross-origin)"}catch{a.isInteractive=!0}d()},r.onerror=()=>{n=!0,clearTimeout(c),a.error="Iframe failed to load",d()},document.body.appendChild(r)}),k=t=>{try{return new URL(t).origin===window.location.origin}catch{return!1}},N=t=>{try{const a=new URL(t),s=a.hostname.toLowerCase(),r=a.pathname.toLowerCase(),n=["crazygames.com","games.crazygames.com","gameflare.com","kongregate.com","itch.io","gamejolt.com","newgrounds.com","armorgames.com","poki.com","y8.com","html5games.com","netlify.app","github.io","vercel.app"],l=["game","play","arcade","puzzle","shooter","adventure","racing","sports","action","strategy","simulation"],d=n.some(i=>s.includes(i)),c=l.some(i=>r.includes(i)||s.includes(i)),h=a.searchParams.has("game")||a.searchParams.has("play")||a.searchParams.has("id");return d||c||h}catch{return!1}},E=t=>{try{const s=new URL(t).hostname.toLowerCase();return["crazygames.com","games.crazygames.com","gameflare.com","kongregate.com","itch.io","gamejolt.com","newgrounds.com","armorgames.com","poki.com","y8.com","html5games.com"].some(n=>s.includes(n))}catch{return!1}},C=async()=>{const t=u.split(`
`).map(s=>s.trim()).filter(s=>s);if(t.length===0){alert("请输入至少一个游戏链接");return}f(!0),p([]);const a=[];for(const s of t){y(s);const r=await w(s);a.push(r),p([...a])}f(!1),y(""),g==null||g(a)},I=()=>{const t=["URL,可嵌入,可访问,可交互,响应时间(ms),错误信息,重定向URL,Frame选项",...o.map(r=>[r.url,r.canEmbed?"是":"否",r.isAccessible?"是":"否",r.isInteractive?"是":"否",r.responseTime||"",r.error||"",r.redirectUrl||"",r.frameOptions||""].join(","))].join(`
`),a=new Blob([t],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.href=URL.createObjectURL(a),s.download=`iframe-game-check-results-${new Date().toISOString().split("T")[0]}.csv`,s.click()},O=()=>{p([]),b("")};return e.jsxs("div",{className:"max-w-6xl mx-auto p-6 bg-white rounded-lg shadow-lg",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"iframe游戏链接检测工具"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"检测游戏链接是否可以嵌入iframe并直接游玩，无需跳转"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"游戏链接 (每行一个)"}),e.jsx("textarea",{value:u,onChange:t=>b(t.target.value),placeholder:`请输入游戏链接，每行一个
例如：
https://example.com/game1
https://example.com/game2`,className:"w-full h-32 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:x})]}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:C,disabled:x||!u.trim(),className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:x?"检测中...":"开始检测"}),o.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:I,className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"导出结果"}),e.jsx("button",{onClick:O,className:"px-6 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"清空结果"})]})]}),x&&j&&e.jsx("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-3"}),e.jsxs("span",{className:"text-blue-800",children:["正在检测: ",j]})]})}),o.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"检测结果"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:o.filter(t=>t.canEmbed&&t.isInteractive).length}),e.jsx("div",{className:"text-sm text-green-800",children:"完全可用"})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:o.filter(t=>t.canEmbed&&!t.isInteractive).length}),e.jsx("div",{className:"text-sm text-yellow-800",children:"可嵌入但不可交互"})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:o.filter(t=>!t.canEmbed).length}),e.jsx("div",{className:"text-sm text-red-800",children:"无法嵌入"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:o.length}),e.jsx("div",{className:"text-sm text-gray-800",children:"总计"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white border border-gray-200 rounded-lg",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"游戏链接"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"可嵌入"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"可访问"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"可交互"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"响应时间"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"错误信息"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:o.map((t,a)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-3",children:[t.status==="checking"&&e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),t.status==="success"&&e.jsx("div",{className:"w-4 h-4 bg-green-500 rounded-full"}),t.status==="error"&&e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full"})]}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",children:e.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:t.url})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t.canEmbed?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.canEmbed?"是":"否"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t.isAccessible?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.isAccessible?"是":"否"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t.isInteractive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.isInteractive?"是":"否"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:t.responseTime?`${t.responseTime}ms`:"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-red-600 max-w-xs",children:t.error||"-"})]},a))})]})})]})]})},P=()=>e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"iframe游戏链接检测工具"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto",children:"专业的游戏链接检测工具，帮助您快速验证游戏链接是否可以嵌入iframe并直接游玩。 支持批量检测、详细分析和结果导出功能。"})]}),e.jsx(L,{}),e.jsxs("div",{className:"mt-12 bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"使用说明"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"检测功能"}),e.jsxs("ul",{className:"space-y-2 text-gray-600",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-green-500 mr-2",children:"✓"}),e.jsx("span",{children:"检查X-Frame-Options头是否允许嵌入"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-green-500 mr-2",children:"✓"}),e.jsx("span",{children:"验证Content-Security-Policy设置"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-green-500 mr-2",children:"✓"}),e.jsx("span",{children:"测试游戏链接的可访问性"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-green-500 mr-2",children:"✓"}),e.jsx("span",{children:"检测游戏内容的交互性"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-green-500 mr-2",children:"✓"}),e.jsx("span",{children:"测量响应时间和性能"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"结果说明"}),e.jsxs("ul",{className:"space-y-2 text-gray-600",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-green-500 mr-2",children:"✓"}),e.jsxs("span",{children:[e.jsx("strong",{children:"完全可用："}),"可嵌入且可交互"]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-yellow-500 mr-2",children:"⚠"}),e.jsxs("span",{children:[e.jsx("strong",{children:"可嵌入但不可交互："}),"能加载但可能不是游戏"]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-red-500 mr-2",children:"✗"}),e.jsxs("span",{children:[e.jsx("strong",{children:"无法嵌入："}),"被安全策略阻止"]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-gray-500 mr-2",children:"-"}),e.jsxs("span",{children:[e.jsx("strong",{children:"无法访问："}),"链接无效或网络问题"]})]})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"注意事项"}),e.jsxs("ul",{className:"text-blue-700 space-y-1 text-sm",children:[e.jsx("li",{children:"• 某些游戏可能因为跨域限制无法完全检测交互性"}),e.jsx("li",{children:"• 检测结果仅供参考，实际嵌入效果可能因浏览器而异"}),e.jsx("li",{children:"• 建议在目标环境中进行最终测试"}),e.jsx("li",{children:"• 支持的游戏平台：CrazyGames、Kongregate、itch.io等"})]})]})]})]})});export{P as default};
