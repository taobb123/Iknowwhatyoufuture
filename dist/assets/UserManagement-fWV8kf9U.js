import{c as C,h as H,r,z as v,A as J,j as e,U as w,B as Z,D as k,F as G,I as K,J as O}from"./index-BCw3XfMH.js";import{C as A}from"./crown-BH-qU2Kz.js";import{P as Q}from"./plus-B-9IxP9O.js";import{C as V}from"./calendar-B4Glwse2.js";import{T as W}from"./trash-2-SuqbVO2-.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=C("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=C("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]),re=()=>{const{state:_,isSuperAdmin:S}=H(),[U,D]=r.useState([]),[o,E]=r.useState(v()),[M,g]=r.useState(!1),[z,p]=r.useState(!1),[b,f]=r.useState(null),[j,y]=r.useState(null),[t,N]=r.useState({username:"",email:"",password:"",role:"user",isActive:!0}),[n,i]=r.useState(""),[x,m]=r.useState(!1);r.useEffect(()=>{u()},[]);const u=()=>{const s=J();D(s),E(v())},l=s=>{const{name:a,value:d,type:R}=s.target;N(B=>({...B,[a]:R==="checkbox"?s.target.checked:d})),n&&i("")},q=async s=>{if(s.preventDefault(),!t.username.trim()||!t.email.trim()||!t.password.trim()){i("请填写所有必填字段");return}m(!0),i("");try{await G({username:t.username.trim(),email:t.email.trim(),password:t.password,role:t.role,isActive:t.isActive}),u(),g(!1),c(),h("用户添加成功！","success")}catch(a){i(a.message||"添加用户失败")}finally{m(!1)}},L=async s=>{if(s.preventDefault(),!!j){if(!t.username.trim()||!t.email.trim()){i("请填写所有必填字段");return}m(!0),i("");try{const a={username:t.username.trim(),email:t.email.trim(),role:t.role,isActive:t.isActive};t.password.trim()&&(a.password=t.password),await K(j.id,a),u(),p(!1),y(null),c(),h("用户更新成功！","success")}catch(a){i(a.message||"更新用户失败")}finally{m(!1)}}},T=async()=>{if(b)try{await O(b),u(),f(null),h("用户删除成功！","success")}catch{h("删除用户失败","error")}},I=s=>{y(s),N({username:s.username,email:s.email,password:"",role:s.role,isActive:s.isActive}),p(!0)},c=()=>{N({username:"",email:"",password:"",role:"user",isActive:!0}),i("")},h=(s,a)=>{const d=document.createElement("div");d.innerHTML=`
      <div style="
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${a==="success"?"#10B981":"#EF4444"};
        color: white;
        padding: 16px 24px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        z-index: 9999;
        font-family: system-ui, -apple-system, sans-serif;
        font-size: 14px;
        font-weight: 500;
      ">
        ${a==="success"?"✅":"❌"} ${s}
      </div>
    `,document.body.appendChild(d),setTimeout(()=>{d.remove()},3e3)},F=s=>{switch(s){case"superAdmin":return e.jsx(A,{className:"h-4 w-4 text-yellow-400"});case"admin":return e.jsx(k,{className:"h-4 w-4 text-blue-400"});default:return e.jsx(w,{className:"h-4 w-4 text-gray-400"})}},P=s=>{switch(s){case"superAdmin":return"超级管理员";case"admin":return"管理员";default:return"普通用户"}},$=s=>new Date(s).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return S()?e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white",children:[e.jsx("div",{className:"pt-16"}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-6",children:"用户管理"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-gray-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{className:"h-8 w-8 text-blue-400"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"总用户数"}),e.jsx("p",{className:"text-2xl font-bold",children:o.total})]})]})}),e.jsx("div",{className:"bg-gray-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"h-8 w-8 text-green-400"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"活跃用户"}),e.jsx("p",{className:"text-2xl font-bold",children:o.active})]})]})}),e.jsx("div",{className:"bg-gray-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-8 w-8 text-blue-400"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"管理员"}),e.jsx("p",{className:"text-2xl font-bold",children:o.admins})]})]})}),e.jsx("div",{className:"bg-gray-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{className:"h-8 w-8 text-yellow-400"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"超级管理员"}),e.jsx("p",{className:"text-2xl font-bold",children:o.superAdmins})]})]})})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>{c(),g(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Q,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"添加用户"})]})}),e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"用户信息"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"角色"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"状态"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"创建时间"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:U.map(s=>e.jsxs("tr",{className:"hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:s.username}),e.jsxs("div",{className:"text-sm text-gray-400 flex items-center gap-1",children:[e.jsx(X,{className:"h-3 w-3"}),s.email]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[F(s.role),e.jsx("span",{className:"text-sm text-gray-300",children:P(s.role)})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.isActive?"活跃":"禁用"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-400",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(V,{className:"h-3 w-3"}),$(s.createdAt)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>I(s),className:"text-blue-400 hover:text-blue-300 p-1",title:"编辑用户",children:e.jsx(Y,{size:16})}),e.jsx("button",{onClick:()=>f(s.id),className:"text-red-400 hover:text-red-300 p-1",title:"删除用户",children:e.jsx(W,{size:16})})]})})]},s.id))})]})})}),M&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-white",children:"添加用户"}),e.jsxs("form",{onSubmit:q,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"用户名"}),e.jsx("input",{type:"text",name:"username",value:t.username,onChange:l,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"邮箱"}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:l,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"密码"}),e.jsx("input",{type:"password",name:"password",value:t.password,onChange:l,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"角色"}),e.jsxs("select",{name:"role",value:t.role,onChange:l,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"user",children:"普通用户"}),e.jsx("option",{value:"admin",children:"管理员"}),e.jsx("option",{value:"superAdmin",children:"超级管理员"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:t.isActive,onChange:l,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-600 rounded bg-gray-700"}),e.jsx("label",{className:"ml-2 text-sm text-gray-300",children:"激活用户"})]})]}),n&&e.jsx("div",{className:"mt-4 text-red-400 text-sm",children:n}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>{g(!1),c()},className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-500 transition-colors",children:"取消"}),e.jsx("button",{type:"submit",disabled:x,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:x?"添加中...":"添加"})]})]})]})}),z&&j&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-white",children:"编辑用户"}),e.jsxs("form",{onSubmit:L,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"用户名"}),e.jsx("input",{type:"text",name:"username",value:t.username,onChange:l,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"邮箱"}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:l,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"新密码（留空则不修改）"}),e.jsx("input",{type:"password",name:"password",value:t.password,onChange:l,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"留空则不修改密码"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"角色"}),e.jsxs("select",{name:"role",value:t.role,onChange:l,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"user",children:"普通用户"}),e.jsx("option",{value:"admin",children:"管理员"}),e.jsx("option",{value:"superAdmin",children:"超级管理员"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:t.isActive,onChange:l,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-600 rounded bg-gray-700"}),e.jsx("label",{className:"ml-2 text-sm text-gray-300",children:"激活用户"})]})]}),n&&e.jsx("div",{className:"mt-4 text-red-400 text-sm",children:n}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>{p(!1),y(null),c()},className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-500 transition-colors",children:"取消"}),e.jsx("button",{type:"submit",disabled:x,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:x?"更新中...":"更新"})]})]})]})}),b&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-white",children:"确认删除"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"确定要删除这个用户吗？此操作无法撤销。"}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>f(null),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-500 transition-colors",children:"取消"}),e.jsx("button",{onClick:T,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-500 transition-colors",children:"删除"})]})]})})]})]}):e.jsx("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-400 text-xl mb-4",children:"权限不足"}),e.jsx("p",{className:"text-gray-400",children:"只有超级管理员可以访问用户管理页面"})]})})};export{re as default};
